{% load helpertags %}


<nav>
    <div id="filter-help" class="code hidden">
        Start typing to filter&hellip;
    </div>

    <div id="filter-display" class="code hidden">
    
    </div>
</nav>

<div id="search"></div>

<script src="{% build_media_url '/js/query.js' %}"></script>

<script id="query-template" type="x-js-template">

    <% if (query.get('summarylevel')) { %>
        Find data for <b><%= query.get('summarylevelDisplay') %></b>
    <% } else { %>
        Find data for
        <span id="summarylevel-select">
          <span class="link" data-val="tract">Tracts</span>,
          <span class="link" data-val="place">Places</span>,
          <span class="link" data-val="subdivision">County Subdivisions</span>,
          <span class="link" data-val="county">Counties</span>,
          <span class="link" data-val="state">States</span>, or
          <span class="link" data-val="nation">the USA</span>.
      </span>
    <% } %>

    <% if (query.get('summarylevel') && (query.get('summarylevel') != 'nation') && !query.get('state')) { %>
        in
        <span id="state-select">
            <% var states = query.filtered(query.mappings.states); %>
            <% _.each(states, function(pair, i) { %>
                <span class="link" data-val="<%= pair[1] %>"><%= pair[0] %></span><%= i == states.length - 1 ? '' : ', ' %>
            <% }); %>
        </span>
    <% } else if (query.get('state')) { %>
        in <b><%= query.get('stateDisplay') %></b>
    <% } %>

    <% if (query.mappings.counties && !query.get('county')) { %>
        for
        <span id="county-select">
            <% var counties = query.filtered(query.mappings.counties); %>
            <% _.each(counties, function(pair, i) { %>
                <span class="link" data-val="<%= '' + pair[2] + pair[1] %>"><%= pair[0] %></span><%= i == counties.length - 1 ? '' : ', ' %>
            <% }); %>
        </span>
    <% } else if (query.get('county')) { %>
        - <b><%= query.get('countyDisplay') %></b>.
    <% } %>

    <% if (query.mappings.places && !query.get('place')) { %>
        for
        <span id="place-select">
            <% var places = query.filtered(query.mappings.places); %>
            <% _.each(places, function(pair, i) { %>
                <span class="link" data-val="<%= pair[1] %>"><%= pair[0] %></span><%= i == places.length - 1 ? '' : ', ' %>
            <% }); %>
        </span>
    <% } else if (query.get('place')) { %>
        - <b><%= query.get('placeDisplay') %></b>.
    <% } %>

    <% if (query.mappings.subdivisions && !query.get('subdivision')) { %>
        for
        <span id="subdivision-select">
            <% var subdivisions = query.filtered(query.mappings.subdivisions); %>
            <% _.each(subdivisions, function(pair, i) { %>
                <span class="link" data-val="<%= pair[1] %>"><%= pair[0] %></span><%= i == subdivisions.length - 1 ? '' : ', ' %>
            <% }); %>
        </span>
    <% } else if (query.get('subdivision')) { %>
        - <b><%= query.get('subdivisionDisplay') %></b>.
    <% } %>

    <% if (query.mappings.tracts && !query.get('tract')) { %>
        for
        <span id="tract-select">
            <% var tracts = query.filtered(query.mappings.tracts); %>
            <% _.each(tracts, function(pair, i) { %>
                <span class="link" data-val="<%= pair[1] %>"><%= pair[0] %></span><%= i == tracts.length - 1 ? '' : ', ' %>
            <% }); %>
        </span>
    <% } else if (query.get('tract')) { %>
        - <b><%= query.get('tractDisplay') %></b>.
    <% } %>

    <% if (query.isCompletable()) { %>
        <span id="proceed">
            <span class="button go">Go</span> or
            <span class="button another">Add Another</span>
        </span>
    <% } %>

    <div id="help-link">Huh?</div>

</script>