{% extends 'base.html' %}
{% load helpertags %}

{% block content %}

<nav>
    <span class="button more-data">Add another geography to compare</span>
</nav>
<div class="query-builder-popup hidden">
    {% include "_query_builder.html" %}
</div>

<script type="text/javascript">
    $(function(){
        $('.button.more-data').click(function(){
            $('.query-builder-popup').dialog({minHeight:400, minWidth:800});
        });
        $('.button.remove-report').click(function(){
            slug = $(this).attr('data-val');
            newLocation = window.location.pathname.replace('/' + slug,'');
            if (newLocation == '/data.html') {
                //you've closed the last report, time to go home
                window.location = '/';                
            } else {
                window.location = newLocation;
            }

        });
    });
</script>

<table class="reports">
    <tr>
        {% for report in reports %}
        <td>
            <table class="report">
                <tr class="title">
                    <th colspan="6">
                        Tract #{{ report.tract_id }} - {{ report.county_name }}, {{ report.state_name }}
                        <span class="button remove-report" data-val="{{ report.slug }}">X</span>
                    </th>
                </tr>
            {% for row in report %}
                {% if row.header %}
                <tr>
                    <th class="section" colspan="6">{{ row.label }} <span class="help_text" onclick="alert('{{ row.help_text|escapejs }}');">Huh?</span></th>
                </tr>
                <tr class="header">
                    <th class="first">Subject</th>
                    <th>Total<br/>2000</th>
                    <th>%<br/>2000</th>
                    <th>Total<br/>2010</th>
                    <th>%<br/>2010</th>
                    <th class="last">%<br/>chg</th>
                </tr>
                {% else %}
                <tr class="{% cycle odd,even %} indent-{{ row.indent }}">
                    <td class="first">{{ row.label }}</td>
                    <td class="code">{{ row.census2000|default_if_none:"" }}</td>
                    <td class="code">{{ row.pct2000|floatformat:-3|default_if_none:"" }}</td>
                    <td class="code">{{ row.census2010|default_if_none:"" }}</td>
                    <td class="code">{{ row.pct2010|floatformat:-3|default_if_none:"" }}</td>
                    <td class="code last">{{ row.delta|floatformat:-3|default_if_none:"" }}</td>
                </tr>
                {% endif %}
            {% endfor %}
            </table>
        </td>
        {% endfor %}
    </tr>
</table>

{% endblock %}