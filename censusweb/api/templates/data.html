{% extends 'base.html' %}

{% block content %}

<nav>
    <span class="button more-data">Add another geography to compare</span>
    &nbsp;or download as
    <a class="button" href="{{ csv_url }}">CSV (TKTK)</a>
    <a class="button" href="{{ json_url }}">JSON (TKTK)</a>
</nav>
<div class="query-builder-popup hidden">
    {% include "_query_builder.html" %}
</div>

<script type="text/javascript">
    $(function(){
        $('.button.more-data').click(function(){
            $('.query-builder-popup').dialog({minHeight:400, minWidth:800});
        });
    });
</script>

{% for r in reports %}
<table class="report">
    <tr>
        <th rowspan="2">{{ r.table }}<br /><span class="universe">Universe: {{ r.universe }}</span></th>
        {% for c in r.columns %}
        <th colspan="4">
            {{ c.name }}
            {% if show_remove_button %}
                <span class="button remove-column" data-val="{{ c.geoid }}">X</span>
            {% endif %}
        </th>
        {% endfor %}
    <tr>
        {% for c in r.columns %}
        <th class="subhead">2000</th>
        <th class="subhead">2010</th>
        <th class="subhead">Delta</th>
        <th class="subhead">% change</th>
        {% endfor %}
    </tr>
    </tr>
    {% for label, data, key in r.rows %}
    <tr
        class="{% cycle odd,even %} indent-{{ label.indent }} row {% if label.has_children %} has-children {% if label.indent > 1 %}closed{% else %}open{% endif %}{% endif %}"
        id="{{ key }}" parent="{{ label.parent }}"
        style="{% if label.indent > 2 %}display:none;{% endif %}"
    >
        <td class="label">{{ label.text }} <span class="key">{{ key }}</span></td>
        {% for d in data %}
            <td class="code">{{ d.2000 }}</td>
            <td class="code">{{ d.2010 }}</td>
            <td class="code">{{ d.delta }}</td>
            <td class="code {% if forloop.last %}last{% endif %}">{{ d.pct_change|floatformat:-3 }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
</table>
{% endfor %}

{% endblock %}
